[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "NYCRestaurant_Inspection",
    "section": "",
    "text": "1 Introduction\nAs a current resident in NYC, it is very hard to choose which restaurant to go among countless restaurants in NYC. It might be harder to choose restaurants in NYC to some people, who care about sanitation a lot because of some health issues. The dataset, which includes NYC restaurant and college cafeteria inspection results for up to three years prior to the most recent inspection, can provide information on recent inspection results of current NYC restaurants. This project can be helpful for deciding which restaurants to be visited or not to be visited, especially to people who need to care a lot about their diets and cleanliness.\nThe main questions of this project is finding relationship between inspection result (scores, critical flag, legal action) and locations/cuisines.\n\nAre inspection results, especially scores and critical flag, related to locations? Let’s visualize some restaurants by using critical flag proportion on the map for the target audiences.\nAre inspection results, especially scores, related to cuisines?\nChain restaurants have worse inspection scores than independent restaurants?\n\nThe dataset contains every sustained or not yet adjudicated violation citation from every full or special food inspection conducted up to three years prior to the most recent inspection for restaurants and college cafeterias in an active status on the RECORD DATE. So only restaurants in an active status are included in the dataset. Restaurants, which have more than one violation in inspection, values for associated fields are repeated for each additional violation record, and each cases are differentiated by their CAMIS (record ID) number. Restaurants, that has applied for a permit but has not yet been inspected and for inspections, result in no violations. Inspection date of 1/1/1900 are new establishments that have not yet received an inspection. Restaurants that received no violations are represented by a single row and coded as having no violations using the ACTION field. The inspection program allows for a two-step inspection process, providing an opportunity for restaurants who do not receive an “A” on their initial inspection to be re-inspected. This re-inspection occurs no less than 7 days after the initial inspection.\nNote that\n\nAfter the inspections, restaurants can go through the adjudication process or argue their case at an administrative hearing.\nRestaurants have appeal rights that the entire adjudication process can take several months.\nScores current as of today may be revised due to adjudication.\nSince restaurants out of business are removed, this project is not about comparison with the past inspection results for NYC restaurants. Also, the score can be revised due to adjudication, it is not valid to compare current scores to scores from previous years.\nLetter grading inspections were put on pause from March 17, 2020 to July 19, 2021, due to the COVID-19 public health emergency. Modified restaurant inspections occurred during this time."
  },
  {
    "objectID": "data.html#technical-description",
    "href": "data.html#technical-description",
    "title": "2  Data",
    "section": "2.1 Technical Description",
    "text": "2.1 Technical Description\n\n\nCode\nsummary(data)\n\n\n     CAMIS              DBA                BORO             BUILDING        \n Min.   :30075445   Length:209461      Length:209461      Length:209461     \n 1st Qu.:41650772   Class :character   Class :character   Class :character  \n Median :50067509   Mode  :character   Mode  :character   Mode  :character  \n Mean   :47562487                                                           \n 3rd Qu.:50107236                                                           \n Max.   :50144695                                                           \n                                                                            \n    STREET             ZIPCODE         PHONE           CUISINE DESCRIPTION\n Length:209461      Min.   : 8512   Length:209461      Length:209461      \n Class :character   1st Qu.:10023   Class :character   Class :character   \n Mode  :character   Median :11101   Mode  :character   Mode  :character   \n                    Mean   :10708                                         \n                    3rd Qu.:11231                                         \n                    Max.   :12345                                         \n                    NA's   :2684                                          \n INSPECTION DATE       ACTION          VIOLATION CODE     VIOLATION DESCRIPTION\n Length:209461      Length:209461      Length:209461      Length:209461        \n Class :character   Class :character   Class :character   Class :character     \n Mode  :character   Mode  :character   Mode  :character   Mode  :character     \n                                                                               \n                                                                               \n                                                                               \n                                                                               \n CRITICAL FLAG          SCORE           GRADE            GRADE DATE       \n Length:209461      Min.   :  0.00   Length:209461      Length:209461     \n Class :character   1st Qu.: 11.00   Class :character   Class :character  \n Mode  :character   Median : 19.00   Mode  :character   Mode  :character  \n                    Mean   : 22.82                                        \n                    3rd Qu.: 31.00                                        \n                    Max.   :168.00                                        \n                    NA's   :9954                                          \n RECORD DATE        INSPECTION TYPE       Latitude       Longitude     \n Length:209461      Length:209461      Min.   : 0.00   Min.   :-74.25  \n Class :character   Class :character   1st Qu.:40.68   1st Qu.:-73.99  \n Mode  :character   Mode  :character   Median :40.73   Median :-73.96  \n                                       Mean   :40.20   Mean   :-72.99  \n                                       3rd Qu.:40.76   3rd Qu.:-73.90  \n                                       Max.   :40.91   Max.   :  0.00  \n                                       NA's   :274     NA's   :274     \n Community Board Council District   Census Tract            BIN         \n Min.   :101.0   Length:209461      Length:209461      Min.   :1000000  \n 1st Qu.:106.0   Class :character   Class :character   1st Qu.:1051363  \n Median :302.0   Mode  :character   Mode  :character   Median :3022138  \n Mean   :254.7                                         Mean   :2577940  \n 3rd Qu.:401.0                                         3rd Qu.:4006875  \n Max.   :595.0                                         Max.   :5799501  \n NA's   :3231                                          NA's   :4226     \n      BBL                NTA            Location Point1\n Min.   :1.000e+00   Length:209461      Mode:logical   \n 1st Qu.:1.011e+09   Class :character   NA's:209461    \n Median :3.008e+09   Mode  :character                  \n Mean   :2.467e+09                                     \n 3rd Qu.:4.005e+09                                     \n Max.   :5.270e+09                                     \n NA's   :553                                           \n\n\n\nData Collection: Data is collected from NYC Open data and provided by Department of Health and Mental Hygiene (DOHMH)\n\nLink: https://data.cityofnewyork.us/Health/DOHMH-New-York-City-Restaurant-Inspection-Results/43nn-pn8j\n\nThe format of the data: CSV file\nThe frequency of updates: Daily updates\nData Import: Daily download from the NYC Open Data website and push to Github\nUnclear columns:\n\nBIN:\n\nFormat: numeric with 7 digits\nMeaning: Building Identification Number\n\nBBL:\n\nFormat: numeric with 10 digits\nMeaning: Borough, Block, and Lot\n\nNTA:\n\nFormat: char, letters+numbers with 4 characters\nMeaning: Neighborhood Tabulation Area\n\nCouncil District\n\nFormat: char, from 1 to 51 in New York\nMeaning: Each number uniquely identifies a specific council district within the city\n\nCensus Tract\n\nFormat: char with 6 digits\nMeaning: Census tracts are small, relatively permanent statistical subdivisions of a county or equivalent entity designed to be relatively homogeneous units concerning population characteristics, economic status, and living conditions\n\n\nDimension:\n\nIdentification: CAMIS (a unique identifier for each establishment), DBA (Doing Business As, the name of the establishment), and contact information such as PHONE.\nLocation: This includes BORO (borough), BUILDING (building number), STREET, ZIPCODE, and more detailed geographical identifiers such as Latitude, Longitude, Community Board, Council District, Census Tract, BIN (Building Identification Number), BBL (Borough, Block and Lot), NTA (Neighborhood Tabulation Area), and Location Point1.Inspection\nInspection Details: CUISINE DESCRIPTION (type of food served), INSPECTION DATE, ACTION (the result of the inspection), VIOLATION CODE, VIOLATION DESCRIPTION, CRITICAL FLAG (whether the violation is critical or not), and INSPECTION TYPE.\nScoring and Grading: SCORE (the score received on the inspection), GRADE (the grade assigned post-inspection), and GRADE DATE (when the grade was issued).\nAdministrative: RECORD DATE (when the data was recorded or updated in the dataset).\n\nIssues and Problems with this dataset:\n\nAdjudication Delays:\n\nThe adjudication process can take several months, during which scores and grades may be revised. Current scores may not be final and are subject to change upon the completion of adjudication.\n\nDiscrepancies between SCORE and GRADE:\n\nThey should be consistent but because of limitations in data system they may be not. Expected corresponding grades for scores (A for 0-13, B for 14-27, C for 28+) might not always match.\nWhen initial inspections are adjudicated down to an A score, no grade is assigned until the re-inspection, which is why an accompanying grade might be absent.\nExample: a grade card was given out but the record of that grade issuance is missing from the data system even if SCORE is populated\n\n\nConvert Datatype:\n\nnumeric to char: BIN, BBL, Community Board\nchar to date: GRADE DATE, RECORD DATE, INSPECTION DATE\n\nSource:\n\nNew York City Department of Health and Mental Hygiene (DOHMH)\n\nwww.nyc.gov/health/foodservice\n\nBlue Book provided by NYC (DOHMH)\n\nhttp://www1.nyc.gov/assets/doh/downloads/pdf/rii/blue-book.pdf"
  },
  {
    "objectID": "data.html#research-plan",
    "href": "data.html#research-plan",
    "title": "2  Data",
    "section": "2.2 Research Plan",
    "text": "2.2 Research Plan\nNote that there are a lot of NA values in variable GRADE, variable SCORE (inspection score) would be mainly used for this project, and variables that will not be used are going to be dropped in the results.qmd file. To begin with, for background information for the main research questions of the project, CUISINE DESCRIPTION (type of food served) will be visualized on the NYC map to find if there are specific cuisines are located on specific cities or BORO (borough) more than other cuisines.\nThe first main question of this project is finding relationship between inspection scores and locations. Variables such as BORO (borough), STREET, Latitude, and Longitude represent the location of each restaurant. The main focus would be finding relationship between BORO (borough) and SCORE (inspection score)/CRITICAL FLAG (whether the violation is critical or not). The inspection scores will be visualized on the NYC map by BORO (borough). After that, for a more detailed analysis, we would work visualize certain restaurants by Latitude and Longitude with their scores. For example, restaurants with good scores on the map and restaurants with bad scores or whose CRITICAL FLAG is critical can be visualized on the map.\nAnother main question of this project is finding relationship between inspection scores and cuisines by using variables CUISINE DESCRIPTION (type of food served) and SCORE (inspection score). We expect to find meaningful patterns such as specific cuisines have good or bad inspection scores. Other than the inspection scores, we would try finding a pattern between cuisines and specific VIOLATION DESCRIPTION/VIOLATION CODE to get a detailed information about violations. We also expect to find if certain cuisines have certain violations more than other cuisines.\nIn short, by using variables BORO, STREET, Latitude, Longitude, SCORE, and CRITICAL FLAG, we expect to find some meaningful patterns between locations and inspection scores. And restaurants whose scores are good or bad would be visualized on the map for audiences who want to sort restaurants out for an actual visit. Secondly, by using variables CUISINE DESCRIPTION, VIOLATION DESCRIPTION/VIOLATION CODE, and SCORE, we expect to find some meaningful patterns between cuisines and inspection score/violation types. Note that after the inspections, restaurants can go through the adjudication process or argue their case at an administrative hearing. Also restaurants have appeal rights that the entire adjudication process can take several months. For a deeper research, ACTION (the result of the inspection) would be analyzed by locations and cuisines, but if there are no patterns between variables, we would skip this part."
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.3 Missing value analysis",
    "text": "2.3 Missing value analysis\n\n2.3.1 Bar Chart\n\n\nCode\nDataExplorer::plot_missing(data, theme_config =list(axis.text=element_text(size=6)))\n\n\n\n\n\nLocation Point1 has 100% of missing value, which can be removed. GRADE DATE has the second highest percentage of missing data, at 55.1% (marked in red), which is considered bad in the chart. GRADE also has a significant amount of missing data, marked in red. This chart suggests that features like GRADE and GRADE DATE may require more attention. On the other hand, features with green bars could be considered relatively clean and may not need as much preprocessing related to missing values. ### Raster Plot\n\n\nCode\nmelted_data &lt;- melt(is.na(data))\nggplot(melted_data, aes(x = Var1, y = Var2)) + \n  geom_raster(aes(fill = value)) +\n  scale_fill_manual(values = c(\"TRUE\" = \"red\", \"FALSE\" = \"grey\")) +\n  labs(x = \"Rows\", y = \"Columns\", fill = \"Missing\\nValue\") +\n  theme(\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.background = element_blank(),\n    axis.line = element_line(colour = \"black\")\n  ) +\n  scale_x_continuous(expand = c(0, 0), limits = c(0, NA)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\nThe plot shows that all data in Location Point1 column are missing, as shown by the red color fill. In addition, GRADE DATE and GRADE are also missing lots of data. Two features are dependent on each other and represent the same dimension, which is grade of the restaurant, so the data points in two features are often missing together.\n\n\n2.3.2 Missing Value Pattern\n\n\nCode\ndata2 &lt;- data\ncolnames(data2) &lt;- substr(colnames(data2), 1, 3)\nredav::plot_missing(data2, percent = TRUE)\n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\n\n\n\nWhen we look at the patterns, the most common pattern is the missing of Location, GRADE DATE, and GRADE, accounting for around 43.75% of the rows. This indicates lots of the discrepancies of GRADE and SCORE that could be due to the reasons mentioned in the section of Technical Description. For pattern2, we have about 39% of the rows only missing Location which is missing in all data."
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "4 Part2: Inspection results by Cuisines\nCode\ndata &lt;- data %&gt;%\n  rename(CUISINE = `CUISINE DESCRIPTION`)\n\ndata %&gt;%\n  drop_na(CUISINE) %&gt;%\n  group_by(CUISINE) %&gt;%\n  dplyr::summarise(\n    cuisine_count = n()\n  ) %&gt;%\n  arrange(desc(cuisine_count)) %&gt;%\n  head(10)\n\n\n# A tibble: 10 × 2\n   CUISINE                  cuisine_count\n   &lt;chr&gt;                            &lt;int&gt;\n 1 American                         34492\n 2 Chinese                          20389\n 3 Coffee/Tea                       13956\n 4 Pizza                            12773\n 5 Latin American                    8312\n 6 Mexican                           8123\n 7 Bakery Products/Desserts          7978\n 8 Caribbean                         7600\n 9 Japanese                          7087\n10 Italian                           7026\n\n\nCode\ntop_cuisines &lt;- data %&gt;%\n  drop_na(CUISINE) %&gt;%\n  group_by(CUISINE) %&gt;%\n  dplyr::summarise(\n    cuisine_count = n()\n  ) %&gt;%\n  arrange(desc(cuisine_count)) %&gt;%\n  head(20) \n\ndata %&gt;%\n  drop_na(CUISINE, SCORE) %&gt;%\n  filter(CUISINE %in% top_cuisines$CUISINE) %&gt;%\n  ggplot(aes(x = SCORE, y = reorder(CUISINE,SCORE,median))) +\n    geom_boxplot(fill=\"#9FC29F\") +\n    labs(title=\"Inspection Scores by CUISINE\",\n         x=\"Inspection Scores\",\n         y=\"CUISINE\") +\n    theme_grey(13)\nCode\ntest3 &lt;- chisq.test(data$SCORE, data$BORO)\nprint(test3)\n\n\n\n    Pearson's Chi-squared test\n\ndata:  data$SCORE and data$BORO\nX-squared = 4509.1, df = 516, p-value &lt; 2.2e-16\nAccording to the visualization, Indian, Spanish, Latin American, Chinese, and Caribbean have top5 highest median of the inspection scores, which means that these cuisines didn’t get really good inspection results. Sandwiches, American, Coffee/Tea, Hamburgers, and Donuts have top5 lowest median of the inspection scores, which means that these cuisines got really good inspection results. Compared to the other cuisines, Sandwiches, Coffee/Tea, Hamburgers, and Donuts are easier to make than other cuisines, so it is understandable that they have less chance to have sanity problems. Note that American food has low inspection score, and we can assume it is because American foods include foods such as Sandwiches, Coffee, Hamburgers, and Donuts. Also, according to the chi-square test, there is strong evidence, which is very small p-value, that there is association between inspection scores and cuisines."
  },
  {
    "objectID": "results.html#part0-background-inspection-scoresgrades",
    "href": "results.html#part0-background-inspection-scoresgrades",
    "title": "3  Results",
    "section": "3.1 Part0: Background: Inspection Scores/Grades",
    "text": "3.1 Part0: Background: Inspection Scores/Grades\n\n\nCode\n# inspection score statistics\ncount &lt;- length(data$SCORE)\nmean &lt;- mean(data$SCORE, na.rm = TRUE)\nstd_dev &lt;- sd(data$SCORE, na.rm = TRUE)\nmin_val &lt;- min(data$SCORE, na.rm = TRUE)\nmax_val &lt;- max(data$SCORE, na.rm = TRUE)\n\n# Displaying the statistics of inspection score\ncat(\"Count:\", count, \"\\nMean:\", mean, \"\\nStandard Deviation:\", std_dev, \"\\nMinimum:\", min_val, \"\\nMaximum:\", max_val, \"\\n\")\n\n\nCount: 209461 \nMean: 22.82137 \nStandard Deviation: 17.54135 \nMinimum: 0 \nMaximum: 168 \n\n\n\n\nCode\ndata %&gt;%\n  drop_na(SCORE) %&gt;%\n  ggplot(aes(x = SCORE)) +\n    geom_histogram(color = \"#80593D\", fill = \"#9FC29F\", alpha = .5, bins = 20, boundary=0) +\n    labs(title = \"NYC restaurants Inspection Scores Distribution\",\n     x = \"Inspection Scores\") +\n     theme_grey(13)\n\n\n\n\n\nMost of the inspection scores are located around mean, which is around 23, and the distribution of the inspection scores is right-skewed. Note that low inspection scores mean good grade, and high inspection scores mean bad grade.\n\n\nCode\ndata %&gt;%\n  drop_na(GRADE) %&gt;%\n  filter(GRADE %in% c(\"A\", \"B\", \"C\")) %&gt;%\n  ggplot(aes(x = GRADE)) +\n    geom_bar(fill=\"#9FC29F\") +\n    labs(title = \"NYC restaurants Inspection Grades Distribution\",\n     x = \"Inspection Grades\") +\n    theme_grey(13)\n\n\n\n\n\nNote that there are around 50% missing data in variable GRADE. Among restaurants which have GRADE data, most of the restaurants got grade A.\n\n\nCode\ndata %&gt;%\n  drop_na(SCORE, GRADE) %&gt;%\n  filter(GRADE %in% c(\"A\", \"B\", \"C\")) %&gt;%\n  ggplot(aes(x = SCORE, y = fct_reorder(GRADE, SCORE, median))) +\n    geom_boxplot(fill=\"#9FC29F\") +\n    labs(title=\"Inspection Scores by Grades\",\n         x=\"Inspection Scores\",\n         y=\"Grades\") +\n    theme_grey(13)\n\n\n\n\n\nThe visualization matches the expected corresponding grades for scores (A for 0-13, B for 14-27, C for 28+), and there are some unknown grades such as N, P, Z, which are dropped in the visualization. Note that grade C has outliers of low inspection scores, which are expected to get A or better grades."
  },
  {
    "objectID": "results.html#part1-inspection-results-by-locations-of-restaurants",
    "href": "results.html#part1-inspection-results-by-locations-of-restaurants",
    "title": "3  Results",
    "section": "3.2 Part1: Inspection results by Locations of Restaurants",
    "text": "3.2 Part1: Inspection results by Locations of Restaurants\n\n\nCode\ndata %&gt;%\n  drop_na(SCORE, BORO) %&gt;%\n  ggplot(aes(x = SCORE, y = reorder(BORO,SCORE,median))) +\n    geom_boxplot(fill=\"#9FC29F\") +\n    labs(title=\"Inspection Scores by BORO\",\n         x=\"Inspection Scores\",\n         y=\"BORO\") +\n    theme_grey(13)\n\n\n\n\n\n\n\nCode\ntest1 &lt;- chisq.test(data$SCORE, data$BORO)\nprint(test1)\n\n\n\n    Pearson's Chi-squared test\n\ndata:  data$SCORE and data$BORO\nX-squared = 4509.1, df = 516, p-value &lt; 2.2e-16\n\n\nAll the boroughs have very similar average inspection scores and distribution. Note that Brooklyn, Manhattan and Queens have some outliers with the highest one in Manhattan. It is hard to tell if there is an association between boroughs and inspection scores by the visualization. However, according to the chi-square test, there is strong evidence, which is very small p-value, that there is association between inspection scores and boroughs.\n\n\nCode\nsubset1 &lt;- data %&gt;%\n  filter(GRADE %in% c(\"A\", \"B\", \"C\"))\n\nvcd::mosaic(GRADE ~ BORO, subset1, direction = c(\"v\", \"h\"), highlighting_fill = c(\"#35E445\", \"#1B3BF2\", \"#F2281B\"))\n\n\n\n\n\nCode\ntest2 &lt;- chisq.test(data$GRADE, data$BORO)\nprint(test2)\n\n\n\n    Pearson's Chi-squared test\n\ndata:  data$GRADE and data$BORO\nX-squared = 392.16, df = 20, p-value &lt; 2.2e-16\n\n\nStaten Island has the highest proportion of grade A and lowest proportion of C, which seems the best result among all the boroughs. But the majority of the inspections grades are A in all the boroughs, and all the boroughs have similar proportion of grades according to the mosaic plot. It is hard to tell if there is an association between grades and boroughs by the mosaic plot. However, according to the chi-square test, there is strong evidence, which is very small p-value, that there is association between inspection grades and boroughs.\n\n3.2.1 Average Inspection Scores by Districts\n\n\nCode\ndata$Year = as.Date(data$`GRADE DATE`, format = \"%m/%d/%Y\")\ndata$Year &lt;- format(data$Year, format = \"%Y\")\ndata$Year &lt;- as.numeric(data$Year)\ndata1 &lt;- data %&gt;% \n  filter(!is.na(Year) & !is.na(SCORE) & !is.na(BORO) & Year&gt;2015 & !is.na(`Council District`) & !is.na(DBA) & !is.na(Latitude) & !is.na(Longitude) & !is.na(SCORE) & `Longitude` != 0 & `Latitude` != 0)\n\n\navg_scores &lt;- data1 %&gt;%\n  group_by(`Council District`) %&gt;%\n  summarize(AvgScore = mean(SCORE))\navg_scores$`Council District` &lt;- as.character(as.numeric(avg_scores$`Council District`))\n# Read the geojson for NYC, make sure it includes council districts\nnyc_districts &lt;- st_read(\"NYC_City_Council_Districts.geojson\", quiet = TRUE)\n\n# Join the data with the spatial data on council districts\nnyc_districts &lt;- left_join(nyc_districts, avg_scores, by = c(\"coun_dist\" = \"Council District\"))\n\n# Plotting the map\nggplot(data = nyc_districts) +\n  geom_sf(aes(fill = AvgScore)) +\n  scale_color_viridis_c(trans = \"reverse\") +\n  theme_minimal() +\n  labs(title = \"NYC Council Districts Map with AvgScore\")\n\n\n\n\n\nThe lighter shades on the choropleth map across the districts of Queens suggest lower average scores compared to other boroughs, indicating that the sanitation standards in these areas may require attention and improvement.\n\n\n3.2.2 Average Inspection Scores by Boroughs in every year\n\n\nCode\navgscore_bar &lt;- data1 %&gt;% \n  filter(!is.na(Year) & !is.na(SCORE) & !is.na(BORO) & Year&gt;2015) %&gt;% \n  group_by(BORO, Year)\n\navgscore_bar &lt;- avgscore_bar %&gt;%\n  summarize(Avg_Score = round(mean(SCORE, na.rm = TRUE),0))\n\nggplot(avgscore_bar, aes(fill = BORO, y = Avg_Score, x = Year)) + \n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.9)) +\n  theme_minimal() +\n  geom_text(aes(label = Avg_Score), vjust = -0.3, position = position_dodge(width = 0.9), size = 2 ) +\n \n  labs(title = \"Boroughs - Average Score vs. Year\", x = \"Years\", y = \"Average Score\") +\n  scale_x_continuous(breaks = 2016:2023, labels = 2016:2023) +\n  scale_fill_brewer(palette = \"RdYlBu\") + \n\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n\nAcross all boroughs, it appears to be a trend of fluctuating scores from year to year, with no clear pattern of consistent improvement or decline. Queens has a noticeable score of 18 in 2023, suggesting room for improvement recently."
  },
  {
    "objectID": "results.html#part3-sort-some-restaurants-out-based-on-critical-flags-and-inspection-scores",
    "href": "results.html#part3-sort-some-restaurants-out-based-on-critical-flags-and-inspection-scores",
    "title": "3  Results",
    "section": "4.1 Part3: Sort some restaurants out based on Critical flags and Inspection Scores",
    "text": "4.1 Part3: Sort some restaurants out based on Critical flags and Inspection Scores"
  },
  {
    "objectID": "results.html#sort-out-by-critical-flags",
    "href": "results.html#sort-out-by-critical-flags",
    "title": "3  Results",
    "section": "4.2 Sort out by Critical flags",
    "text": "4.2 Sort out by Critical flags\n\n\nCode\nsubset7 &lt;- data %&gt;%\n  rename(critical_flag = 'CRITICAL FLAG') %&gt;%\n  drop_na(DBA, critical_flag) %&gt;%\n  group_by(DBA) %&gt;%\n  count(critical_flag) %&gt;%\n  pivot_wider(\n    names_from = critical_flag, values_from = n\n  ) %&gt;%\n  rename(Not_Critical = `Not Critical`, Not_Applicable = `Not Applicable`) %&gt;%\n  mutate(\n    Not_Applicable = ifelse(is.na(Not_Applicable), 0, Not_Applicable),\n    Not_Critical = ifelse(is.na(Not_Critical), 0, Not_Critical),\n    Critical = ifelse(is.na(Critical), 0, Critical),\n    Total = Critical + Not_Critical + Not_Applicable) %&gt;%\n  mutate(cf_prop = Critical/(Critical + Not_Critical + Not_Applicable)) %&gt;%\n  arrange(desc(cf_prop))\n\n\n\n\nCode\nmean(subset7$Critical)\n\n\n[1] 5.137253\n\n\nCode\nmean(subset7$Total)\n\n\n[1] 9.418297\n\n\nThe average number of the critical flags per restaurant is around 5, and the mean of the total inspection cases is around 9 per restaurant for last three years (2020-2023).\n\n\nCode\nsubset7 %&gt;%\n  filter(Total &gt; 10) %&gt;%\n  head(20)\n\n\n# A tibble: 20 × 6\n# Groups:   DBA [20]\n   DBA                        Critical Not_Critical Not_Applicable Total cf_prop\n   &lt;chr&gt;                         &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n 1 WE VILLAGE CORP                  12            0              0    12   1    \n 2 PEPERINO                         13            1              0    14   0.929\n 3 IN CHA/TASTE OF GUILIN           12            1              0    13   0.923\n 4 Boishakhi Restaurant             11            1              0    12   0.917\n 5 SWEET CATS CAFE                  11            1              0    12   0.917\n 6 DA NICO RESTAURANT               10            1              0    11   0.909\n 7 JJ BROWN CUP                     10            1              0    11   0.909\n 8 XI JIANG QIAN HU NOODLE I…       10            1              0    11   0.909\n 9 KENKA                            13            2              0    15   0.867\n10 QUEENS BUFFET                    13            2              0    15   0.867\n11 SWEET HOUR                       13            2              0    15   0.867\n12 BAAR BAAR                        19            3              0    22   0.864\n13 ESTRELLITA POBLANA # 1           12            2              0    14   0.857\n14 MASALA KING                      12            2              0    14   0.857\n15 QUATORZE                         12            2              0    14   0.857\n16 TEA CUP CAFE                     12            2              0    14   0.857\n17 VILLAGE SQUARE PIZZA             12            2              0    14   0.857\n18 YONG KANG STREET                 12            2              0    14   0.857\n19 BOBO RESTAURANT                  11            2              0    13   0.846\n20 DA NONNA ROSA                    11            2              0    13   0.846\n\n\nThese are top10 highest critical flag proportion restaurants among restaurants whose total inspection cases are above 10 cases for the last three years.\n\n\nCode\nsubset7 %&gt;%\n  filter(Total &gt; 10) %&gt;%\n  tail(20)\n\n\n# A tibble: 20 × 6\n# Groups:   DBA [20]\n   DBA                        Critical Not_Critical Not_Applicable Total cf_prop\n   &lt;chr&gt;                         &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n 1 NORTH COAST SHARK AND BAKE        3            9              0    12  0.25  \n 2 ORCHARD BEACH SNACK BAR S…        3            9              0    12  0.25  \n 3 PANDA EXPRESS #2622               3            9              0    12  0.25  \n 4 QUICKLY                           3            7              2    12  0.25  \n 5 The Oma                           3            9              0    12  0.25  \n 6 Y J FRIED FISH                    3            8              1    12  0.25  \n 7 ZIBETTO ESPRESSO BAR              3            9              0    12  0.25  \n 8 ARAMARK @ ACCENTURE #19261        3            8              2    13  0.231 \n 9 CABANA JORGE RESTAURANT           3            9              1    13  0.231 \n10 CIBO EXPRESS GOURMET MARK…        4           12              3    19  0.211 \n11 BRONSON'S BURGERS                 3           10              2    15  0.2   \n12 HALAL GRILL EATS                  3            9              3    15  0.2   \n13 CITI FIELD STERLING KITCH…        2            8              1    11  0.182 \n14 KEKI MODERN CAKES                 2            8              1    11  0.182 \n15 LAZY SUNDAES                      2            9              0    11  0.182 \n16 PROPER FOOD                       3           14              0    17  0.176 \n17 CRISPY                            2            9              1    12  0.167 \n18 PENNYLANE COFFEE                  2           10              0    12  0.167 \n19 AGUA E' COCO BAR & GRILL          1            7              3    11  0.0909\n20 RADIO CITY MUSIC HALL             2           10             11    23  0.0870\n\n\nThese are top20 lowest critical flag proportion restaurants among restaurants whose total inspection cases are above 10 for the last three years.\n\n\nCode\n#mean of the critical flag proportion for all inspected restaurants\nmean(subset7$cf_prop)\n\n\n[1] 0.5042503\n\n\nCode\nsubset7 %&gt;%\n  arrange(desc(Critical))\n\n\n# A tibble: 22,178 × 6\n# Groups:   DBA [22,178]\n   DBA                        Critical Not_Critical Not_Applicable Total cf_prop\n   &lt;chr&gt;                         &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n 1 DUNKIN                         1278         1271             33  2582   0.495\n 2 SUBWAY                          779          747             11  1537   0.507\n 3 MCDONALD'S                      492          558              8  1058   0.465\n 4 STARBUCKS                       444          731             14  1189   0.373\n 5 KENNEDY FRIED CHICKEN           375          341              9   725   0.517\n 6 BURGER KING                     307          310              9   626   0.490\n 7 POPEYES                         293          378              7   678   0.432\n 8 CROWN FRIED CHICKEN             264          201              5   470   0.562\n 9 GOLDEN KRUST CARIBBEAN BA…      251          251              5   507   0.495\n10 DUNKIN'                         205          229              2   436   0.470\n# ℹ 22,168 more rows\n\n\nThese are top10 highest accumulated critical flag restaurants for last three years. Since these restaurants are mostly chain restaurants, which have a number of restaurants in NYC. So the result is understandable that these chain restaurants have high accumulated critical flags. And note that these chain restaurants are mostly under the mean of the critical flag proportion for all inspected restaurants (0.5), so it is hard to say chain restaurants have more critical flags than other restaurants.\n\n\nCode\nbd_by_cfprop &lt;- subset7 %&gt;%\n  filter(Total &gt; 10) %&gt;%\n  head(40)\ngd_by_cfprop &lt;- subset7 %&gt;%\n  filter(Total &gt; 10) %&gt;%\n  tail(40)\n\n# left join DBA\nloc = data[!duplicated(data$DBA), c(\"DBA\", \"Latitude\", \"Longitude\")]\nbd_by_cfprop &lt;- left_join(bd_by_cfprop, loc, by = c(\"DBA\" = \"DBA\"))\n#bd_by_score &lt;- left_join(bd_by_score, loc, by = c(\"DBA\" = \"DBA\"))\ngd_by_cfprop &lt;- left_join(gd_by_cfprop, loc, by = c(\"DBA\" = \"DBA\"))\n#gd_by_score &lt;- left_join(gd_by_score, loc, by = c(\"DBA\" = \"DBA\"))\n\n# check overlap\n# merge_bd &lt;- rbind(bd_by_cfprop, bd_by_score)\n# merge_bd &lt;- distinct(merge_bd, DBA, .keep_all = TRUE)\n# merge_bd &lt;- merge_bd[, c(\"DBA\", \"cf_prop\", \"avg_score\", \"Latitude\", \"Longitude\")]\n# merge_bd$grade = 0\n# merge_gd &lt;- rbind(gd_by_cfprop, gd_by_score)\n# merge_gd &lt;- distinct(merge_gd, DBA, .keep_all = TRUE)\n# merge_gd &lt;- merge_gd[, c(\"DBA\", \"cf_prop\", \"avg_score\", \"Latitude\", \"Longitude\")]\n# merge_gd$grade = 1\nbd_by_cfprop &lt;- bd_by_cfprop[, c(\"DBA\", \"cf_prop\", \"Latitude\", \"Longitude\")]\nbd_by_cfprop$Grade = \"bad\"\ngd_by_cfprop &lt;- gd_by_cfprop[, c(\"DBA\", \"cf_prop\", \"Latitude\", \"Longitude\")]\ngd_by_cfprop$Grade = \"good\"\nmerge_bdgd &lt;- rbind(bd_by_cfprop, gd_by_cfprop)\ncolnames(merge_bdgd)[colnames(merge_bdgd) == \"cf_prop\"] = \"Critical_Flag_Proportion\"\ncolnames(merge_bdgd)[colnames(merge_bdgd) == \"DBA\"] = \"Restaurant_Name\"\n#write.csv(merge_bdgd, \"tidydata.csv\", row.names=FALSE)\n\n\n\n4.2.1 Interactive plot for sorting restaurants out by Critical Flag proportion.\n\n\nCode\n# interactive map - score vs long and lat\n# filter the data\ntmap_data = merge_bdgd\n\n# Convert restaurant data to sf object\ntmapdata_sf &lt;- st_as_sf(tmap_data, coords = c(\"Longitude\", \"Latitude\"), crs = 4326)\n\ntmapdata_sf$color &lt;- ifelse(tmapdata_sf$Grade == \"bad\", \"red\",\"green\")\n\n# Set tmap to view mode\ntmap_mode(\"view\")\n\n\ntmap mode set to interactive viewing\n\n\nCode\n# Plot the base map\ntm_base &lt;- tm_shape(nyc_neighborhoods) +\n  tm_borders() +\n  tm_fill(col = \"grey\", alpha = 0.5) +\n  tm_layout(frame = FALSE)\n  \n\n# Add the restaurant scores with custom colors\ntm_restaurants &lt;- tm_shape(tmapdata_sf) +\n  tm_symbols(\n    size = 0.1, # Replace 'size' with the name of the variable determining the size of the symbols\n    col = \"color\", # The color column created based on the grade\n    border.col = \"black\",\n    border.alpha = 0.5,\n    title.col = \"Restaurant Score\",\n    shape = 21, # Shape 21 is a filled circle, similar to a bubble\n    popup.vars = c(\"Restaurant_Name\" = \"Restaurant_Name\", \"Grade\" = \"Grade\", \"Critical_Flag_Proportion\" = \"Critical_Flag_Proportion\")\n  )\n\n\n# +\n#   tm_bubbles(size = 0.5, col = \"color\", \n#              border.col = \"black\", border.alpha = 0.5,\n#              title.col = \"Restaurant Score\",\n#              style = \"pretty\",\n#              labels = \"1\")\n\n\n# Combine the layers and print the map\ntm_map &lt;- tm_base + tm_restaurants + tm_add_legend(\"fill\", col = c(\"red\", \"green\"), \n                labels = c(\"Bad\", \"Good\"),\n                title = \"Legend\",\n                size = 1)\n \n# tmap_save(tm_map, \"try_map.html\")"
  },
  {
    "objectID": "results.html#sort-out-by-inspection-scores",
    "href": "results.html#sort-out-by-inspection-scores",
    "title": "3  Results",
    "section": "4.3 Sort out by Inspection scores",
    "text": "4.3 Sort out by Inspection scores\n\n\nCode\nsubset8 &lt;- data %&gt;%\n  drop_na(DBA, SCORE) %&gt;%\n  filter(GRADE %in% c(\"A\", \"B\", \"C\")) %&gt;%\n  group_by(DBA) %&gt;%\n  dplyr::summarise(cases = n(), avg_score = mean(SCORE)) %&gt;%\n  arrange(desc(avg_score)) \n\n\n\n\nCode\nsubset8 %&gt;%\n  filter(cases &gt; 10) %&gt;%\n  select(DBA, avg_score) \n\n\n# A tibble: 750 × 2\n   DBA                   avg_score\n   &lt;chr&gt;                     &lt;dbl&gt;\n 1 NEW RED LANTERN            88  \n 2 SPICY PALACE               85  \n 3 TWIN THUMB RESTAURANT      82.4\n 4 PI GREEK BAKERIE           79.4\n 5 GAMMEEOK                   79  \n 6 ASIAN FOOD LTD             71.2\n 7 HUNDRED TASTE              70.4\n 8 GOTTA GETTA BAGEL          66  \n 9 SLICE                      65  \n10 CAFFE NAPOLI               61.5\n# ℹ 740 more rows\n\n\nThese are top20 highest inspection scores (high score is bad) restaurants among restaurant whose total inspection cases are above 10 for last three years.\n\n\nCode\nsubset8 %&gt;%\n  filter(cases &gt; 10) %&gt;%\n  tail(20)\n\n\n# A tibble: 20 × 3\n   DBA                            cases avg_score\n   &lt;chr&gt;                          &lt;int&gt;     &lt;dbl&gt;\n 1 HARDEE                            14      5.71\n 2 TWO HANDS                         17      5.53\n 3 FUSHIMI                           12      5.17\n 4 CIBO EXPRESS GOURMET MARKET       19      5.16\n 5 NEW APOLLO DINER                  12      5   \n 6 NINO'S PIZZA                      11      4.73\n 7 MIKE'S DAKOTA DINER               14      4.71\n 8 BAR & GRILL 43                    11      4.36\n 9 HUDSON FOOD COURT                 11      4.36\n10 SHANGHAI YOU GARDEN               24      3.12\n11 10TH AVENUE PIZZA & CAFE          11      3   \n12 MASALA GRILL                      11      3   \n13 Pick-A-Bagel                      11      3   \n14 FELIX                             11      2.73\n15 POKE FRESH SUSHI                  13      2.54\n16 RADIO CITY MUSIC HALL             22      2   \n17 ROSA'S PIZZA & PASTA              15      2   \n18 SPICE UP SWEETS AND RESTAURANT    12      2   \n19 LA BARCA RESTAURANT               11      1.82\n20 NEW CHOI HEE                      12      1.5 \n\n\nThese are top20 lowest inspection scores (low score is good) restaurants whose total inspection cases are above 10 for last three years."
  },
  {
    "objectID": "results.html#part4-violation-description-by-word-cloud",
    "href": "results.html#part4-violation-description-by-word-cloud",
    "title": "3  Results",
    "section": "4.4 Part4: Violation description by word cloud",
    "text": "4.4 Part4: Violation description by word cloud\n\n\nCode\nrest_cf &lt;- subset7 %&gt;%\n  filter(Total &gt; 10) %&gt;%\n  head(100) %&gt;%\n  select(DBA)\n\nrest_score &lt;- subset8 %&gt;%\n  filter(cases &gt; 10) %&gt;%\n  head(100) %&gt;%\n  select(DBA)\n\nrests &lt;- c(rest_cf$DBA,rest_score$DBA)\n\n\n\n\nCode\nsubset4 &lt;- data %&gt;%\n  rename(VIOLATION = \"VIOLATION DESCRIPTION\") %&gt;%\n  drop_na(VIOLATION) %&gt;%\n  filter(DBA %in% rests)\n\nwords &lt;- tokenize_words(subset4$VIOLATION, stopwords = stopwords::stopwords(\"en\"))\n\n# violation &lt;- vector()\n# for (i in 1:nrow(subset4)) {\n#     for (j in 1:length(words[[i]])){\n#           violation &lt;- c(final_vector, words[[i]][j])\n#     }\n# }\n# \n# df &lt;- as.data.frame(violation)\n#write.csv(violation, \"violation.csv\", row.names=FALSE)\n\ndf &lt;- read_csv(\"violation.csv\")\n\n\nRows: 33310 Columns: 1\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): x\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nCode\ndf &lt;- df %&gt;%\n  rename(violation = x) %&gt;%\n  count(violation) %&gt;%\n  filter(!violation %in% c(\"food\", \"held\", \"f\", \"non\", \"properly\")) %&gt;%\n  arrange(desc(n)) %&gt;%\n  rename(freq = n) \nwordcloud2(data = df, size = 0.75, shape = 'circle', minSize = 10)\n\n\n\n\n\n\n\nThis is a wordcloud from top100 highest critical flag proportion restaurants and top100 highest inspection scores (high score means bad result) restaurants among all the restaurants whose total inspection cases are above 10 for last three years."
  },
  {
    "objectID": "d3graph.html",
    "href": "d3graph.html",
    "title": "4  Interactive graph",
    "section": "",
    "text": "Zoom In\n\n\nZoom Out"
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "5  Conclusion",
    "section": "",
    "text": "Our research goals were finding association between inspection results and locations of restaurants / cuisines. And at the end, sorting some restaurants based on the inspection results could be a reference for our target audiences.\nAll the boroughs have very similar average inspection scores around 23 and distribution with similar proportion of grades. The majority of the inspections grades are A in all the boroughs. Especially, Staten Island has the highest proportion of grade A and lowest proportion of C, which seems the best result among all the boroughs. According to the chi-square test, there is strong evidence, which is very small p-value, that there is association between inspection grades and boroughs or locations. Based on our research objectives, we sought to explore the relationship between the geographical location and the quality metrics—scores and critical flags—of restaurants. Our analysis spanned multiple levels, including individual districts and borough-wide aggregations. From the choropleth map, we observed that some of districts of Queens are marked by lighter shades, indicating lower average scores relative to other boroughs. In addition, the bar chart reflecting annual trends reveals a peak average score of 18 for Queens in 2023. This juxtaposition suggests that the Queens overall has struggled to maintain consistent sanitation quality levels. The interactive map shows the binary classification of good and bad restaurant based on the critical flag proportion. The markers in Manhattan suggests a high density of restaurants in this borough. The presence of both classification in close proximity could imply a wide variance in the adherence to standards within a small geographical area. The density of markers also underscores the competitive and diverse nature of the food industry in Manhattan, where high concentration of dining options coexist. Incorporating D3’s interactive functionalities into the map significantly enhances the user experience by providing the ability to zoom in on specific districts. This feature allows user to focus on areas of interest and discern the distribution of restaurants that meet high sanitation standards and avoid those which have cleanliness issue. The targeted view would be particularly beneficial for individuals who prioritize healthliness when dining out.\nFor the cuisines, Indian, Spanish, Latin American, Chinese, and Caribbean didn’t get really inspection results as low inspection scores. Sandwiches, American, Coffee/Tea, Hamburgers, and Donuts got good inspection results as high inspection scores. Compared to the other cuisines, Sandwiches, Coffee/Tea, Hamburgers, and Donuts are easier to make than other cuisines, so it is understandable that they have less chance to have sanity problems. Also, according to the chi-square test, there is strong evidence, which is very small p-value, that there is association between inspection scores and cuisines.\nWe could find some meaningful associations between inspection results and locations of restaurants / cuisines. And at the end, we could visualize restaurants based on the inspection results on the NYC map."
  }
]